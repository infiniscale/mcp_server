# Pandoc MCP Server Configuration
# Copy this file to .env and customize as needed
#
# 使用方法:
#   cp .env.example .env
#   # 编辑 .env 文件
#   docker-compose up -d

# === Docker Configuration ===
# 服务端口（仅 Docker 部署使用）
MCP_PORT=20000

# === Basic Configuration ===
# Directory for converted output files
PANDOC_OUTPUT_DIR=./output

# Directory for temporary files (uploads, processing)
PANDOC_TEMP_DIR=./temp

# Path to pandoc executable (default: searches PATH)
PANDOC_PATH=pandoc

# Pandoc data directory (optional)
PANDOC_DATA_DIR=


# === Security Configuration - File Size Limits ===
# Maximum upload file size in bytes (for base64 upload)
# Default: 50MB = 52428800
PANDOC_MCP_MAX_UPLOAD_BYTES=52428800

# Maximum local file size in bytes
# Default: 100MB = 104857600
# Set to 0 for unlimited
PANDOC_MCP_MAX_FILE_BYTES=104857600

# Maximum number of files per batch upload request
# Default: 10
PANDOC_MCP_MAX_UPLOAD_FILES=10

# Maximum total size for batch uploads in bytes
# Default: 100MB = 104857600
PANDOC_MCP_MAX_TOTAL_UPLOAD_BYTES=104857600


# === Security Configuration - Path Access Control ===
# Disable local path input entirely (recommended for public deployments)
# Set to true to only allow base64 file uploads
PANDOC_MCP_DISABLE_PATH_INPUT=false

# Disable Pandoc filters (security measure for public deployments)
# Filters can execute arbitrary code, so disable in untrusted environments
PANDOC_MCP_DISABLE_FILTERS=false

# Require all file paths to be in the allowlist
# Set to true to restrict access to specific directories
PANDOC_MCP_REQUIRE_ALLOWLIST=false

# Restrict output file writes to PANDOC_OUTPUT_DIR only
# Set to true to prevent writing files outside the output directory
PANDOC_MCP_RESTRICT_OUTPUT_DIR=false

# Allowed input root directories (comma or path-separator separated)
# Only paths under these directories will be accessible for reading
# Example Linux/Mac: /home/user/documents:/data/shared
# Example Windows: C:\Users\user\Documents,D:\Data
PANDOC_MCP_ALLOWED_INPUT_ROOTS=

# Allowed output root directories (comma or path-separator separated)
# Only paths under these directories will be accessible for writing
# If empty, uses PANDOC_MCP_RESTRICT_OUTPUT_DIR to limit to output dir
PANDOC_MCP_ALLOWED_OUTPUT_ROOTS=


# === Logging Configuration ===
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
PANDOC_LOG_LEVEL=INFO

# Enable debug mode (sets log level to DEBUG and enables extra diagnostics)
PANDOC_DEBUG=false


# === CORS Configuration (HTTP modes) ===
# Comma-separated list of allowed origins. Use * to allow all origins.
PANDOC_MCP_CORS_ALLOW_ORIGINS=


# === MinIO Configuration (optional) ===
# Enable MinIO uploads and pre-signed download URLs
PANDOC_MINIO_ENABLED=false

# MinIO endpoint (host:port, no scheme)
PANDOC_MINIO_ENDPOINT=localhost:9000

# MinIO credentials
PANDOC_MINIO_ACCESS_KEY=
PANDOC_MINIO_SECRET_KEY=

# Target bucket name for converted files
PANDOC_MINIO_BUCKET=pandoc-conversions

# Use HTTPS for MinIO
PANDOC_MINIO_SECURE=false

# Pre-signed URL expiry in seconds (default: 7 days)
PANDOC_MINIO_URL_EXPIRY=604800


# === Deployment Scenario Examples ===

# --- Local Development (Most Permissive) ---
# PANDOC_OUTPUT_DIR=./dev_output
# PANDOC_LOG_LEVEL=DEBUG
# PANDOC_DEBUG=true
# PANDOC_MCP_DISABLE_PATH_INPUT=false
# PANDOC_MCP_DISABLE_FILTERS=false
# PANDOC_MCP_MAX_FILE_BYTES=0

# --- Internal Network Service (Moderate Security) ---
# PANDOC_OUTPUT_DIR=/data/output
# PANDOC_LOG_LEVEL=INFO
# PANDOC_MCP_REQUIRE_ALLOWLIST=true
# PANDOC_MCP_RESTRICT_OUTPUT_DIR=true
# PANDOC_MCP_ALLOWED_INPUT_ROOTS=/home/users:/data/shared
# PANDOC_MCP_MAX_FILE_BYTES=104857600
# PANDOC_MCP_MAX_UPLOAD_FILES=20

# --- Public Production Service (Maximum Security) ---
# PANDOC_OUTPUT_DIR=/var/pandoc/output
# PANDOC_TEMP_DIR=/var/pandoc/temp
# PANDOC_LOG_LEVEL=WARNING
# PANDOC_MCP_DISABLE_PATH_INPUT=true
# PANDOC_MCP_DISABLE_FILTERS=true
# PANDOC_MCP_MAX_UPLOAD_BYTES=26214400
# PANDOC_MCP_MAX_UPLOAD_FILES=5
# PANDOC_MCP_MAX_TOTAL_UPLOAD_BYTES=52428800
